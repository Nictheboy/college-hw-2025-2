# 答案

李甘 2023202296

## 第一题

| | op | rd | rs | imm |
|-| -- | -- | -- | --- |
| 位宽 | 2 | 3 | 3 | 8 |
| 描述 | 操作码 | 目的寄存器 | 源寄存器 | 立即数 |

| op | 0b00 | 0b01 | 0b10 | 0b11 |
| -- | ---- | ---- | ---- | ---- |
|描述 | addi | lw   | sw   | add  |

## 第二题

伪代码：

```text
(0) <- $0
$r1 <- (0)
$r2 <- (1)
$r1 <- $r1 + $r2
$r2 <- (2)
$r1 <- $r1 + $r2
$r2 <- (3)
$r1 <- $r1 + $r2
(0) <- $r1
```

机器码：

| op | rd  | rs  | imm      | hex    |
| -- | --- | --- | -------- | ------ |
| 10 | 000 | 000 | 00000000 | 0x8000 |
| 01 | 001 | 000 | 00000000 | 0x4800 |
| 01 | 010 | 000 | 00000001 | 0x5001 |
| 11 | 001 | 010 | 00000000 | 0xca00 |
| 01 | 010 | 000 | 00000010 | 0x5002 |
| 11 | 001 | 010 | 00000000 | 0xca00 |
| 01 | 010 | 000 | 00000011 | 0x5003 |
| 11 | 001 | 010 | 00000000 | 0xca00 |
| 10 | 001 | 000 | 00000000 | 0x8800 |

## 第三题

### addi

|  | signals |
|--| ------- |
| 0| PC->AB, W/R=0, M/IO=1 |
| 1| PC->AB, W/R=0, M/IO=1 |
| 2| PC->AB, W/R=0, M/IO=1 |
| 3| PC->AB, W/R=0, M/IO=1, CP&(DB->IR), CP&(PC+1) |
| 4| rs->GR, imm->ALU, (rs)->ALU(10), +, CP&(ALU->GR), rd->GR |

### lw

|  | signals |
|--| ------- |
| 0| PC->AB, W/R=0, M/IO=1 |
| 1| PC->AB, W/R=0, M/IO=1 |
| 2| PC->AB, W/R=0, M/IO=1 |
| 3| PC->AB, W/R=0, M/IO=1, CP&(DB->IR), CP&(PC+1) |
| 4| rs->GR, imm->ALU, (rs)->ALU(10), +, CP&(ALU->AR), AR->AB, M/IO=1, W/R=0 |
| 5| AR->AB, M/IO=1, W/R=0 |
| 6| AR->AB, M/IO=1, W/R=0 |
| 7| AR->AB, M/IO=1, W/R=0, CP&(DB->DR) |
| 8| DR->ALU, rd->GR, CP&(ALU->GR) |

### sw

|  | signals |
|--| ------- |
| 0| PC->AB, W/R=0, M/IO=1 |
| 1| PC->AB, W/R=0, M/IO=1 |
| 2| PC->AB, W/R=0, M/IO=1 |
| 3| PC->AB, W/R=0, M/IO=1, CP&(DB->IR), CP&(PC+1) |
| 4| rd>GR, (rd)->ALU, CP&(ALU->DR)|
| 5| rs->GR, imm->ALU, (rs)->ALU(10), +, CP&(ALU->AR), AR->AB, M/IO=1, W/R=1 |
| 6| AR->AB, M/IO=1, W/R=1 |
| 7| AR->AB, M/IO=1, W/R=1 |
| 8| AR->AB, M/IO=1, W/R=1 |

### add

|  | signals |
|--| ------- |
| 0| PC->AB, W/R=0, M/IO=1 |
| 1| PC->AB, W/R=0, M/IO=1 |
| 2| PC->AB, W/R=0, M/IO=1 |
| 3| PC->AB, W/R=0, M/IO=1, CP&(DB->IR), CP&(PC+1) |
| 4| rs->GR, rd->GR, (rs)->ALU, (rd)->ALU, +, CP&(ALU->GR), rd->GR |

### 第四题

各个控制信号都是 op 和阶段数的函数，按照第三题的表格机械地整理即可。
